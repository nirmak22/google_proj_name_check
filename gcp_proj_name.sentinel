import "tfplan"

log("Resources in tfplan:", tfplan.resources)
project_name_rule = rule {
    all tfplan.resources["google_projects"] as _, r {
        log("google project resources r: ", r)
        r != null and r.instances != null and r.instances is list and
        all r.instances as _, instance {
            instance.attributes["name"] is string and instance.attributes["name"].starts_with("kyn")
        
    }
}

main = rule { project_name_rule }
